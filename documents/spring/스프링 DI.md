# 다양한 의존관계 주입 방법

**_의존관계 주입은 크게 4가지 방법이 있다._**

- 생성자 주입
- 수정자 주입(setter 주입)
- 필드 주입
- 일반 메서드 주입

### 생성자 주입

- 이름 그대로 생성자를 통해서 의존 관계를 주입 받는 방법
- 특징
  - 생성자 호출 시점에 딱 1번만 호출되는 것이 보장된다.
  - **불변, 필수** 의존관계에 사용

### 수정자 주입(setter 주입)

- setter라 불리는 필드의 값을 변경하는 수정자 메서드를 통해서 의존관계를 주입하는 방법
- 특징
  - **선택, 변경** 가능성이 있는 의존관계에 사용

### 필드 주입

- 이름 그대로 필드에 바로 주입하는 방법
- 특징
  - 코드가 간결해서 많은 개발자들을 유혹하지만 외부에서 변경이 불가능해서 테스트 하기 힘들다.
  - 테스트 코드나 @Configuration 같은 곳에서만 특별한 용도로 사용하자

### 일반 메서드 주입

- 일반 메서드를 통해서 주입 받을 수 있다.

# 생성자 주입을 선택해라

_불변_

- 대부분의 의존관계 주입은 한번 일어나면 애플리케이션 종료시점까지 의존관계를 변경할 일이 없다. 오히려 대부분의 의존관계는 애플리케이션 종료 전까지 변하면 안된다.

_누락_

- 수정자나 일반 메서드 주입을 사용하면 테스트 시 누락할 수 있다.

_컴파일 오류는 세상에서 가장 빠르고, 좋은 오류다!_

# 자동, 수동의 올바른 실무 운영 기준

### 자동 기능을 기본으로 사용하자!

### 그러면 수동 빈 등록은 언제 사용하면 좋을까?

애플리케이션은 크게 업무 로직과 기술 지원 로직으로 나눌 수 있다.

- **업무 로직 빈** : 웹을 지원하는 컨트롤러, 핵심 비즈니스 로직이 있는 서비스, 데이터 계층의 로직을 처리하는 리포지토리등이 모두 업무 로직이다. 보통 비즈니스 요구사항을 개발할 때 추가되거나 변경된다.
- **기술 지원 빈** : 기술적인 문제나 공통 관심사(AOP)를 처리할 때 주로 사용된다. DB 연결, 공통 로그 처리처럼 업무 로직을 지원하기 위한 하부 기술이나 공통 기술들이다.
- 업무 로직은 숫자도 매우 많고, 한번 개발해야 하면 컨트롤러, 서비스, 리포지토리처럼 어느 정도 유사한 패턴이 있다. 이런 경우 자동 기능을 적극 사용한다.
- 기술 지원 로직은 업무 로직과 비교해서 그 수가 매우 적고, 보통 애플리케이션 전반에 걸쳐서 광범위하게 영향을 미친다. 그리고 업무 로직은 문제가 발생했을 때 어디가 문제인지 명확하게 잘 드러나지만, 기술 지원 로직은 적용이 잘 되고 있는지 아닌지조차 파악하기 어려운 경우가 많다. 그래서 이런 기술 지원 로직들은 가급적 수동 빈 등록을 사용한다.
