# 1. HTTP란?

하이퍼텍스트 전송 규악을 의미한다. 여기서 하이퍼텍스트란 참조를 통해 다른 문서로 즉시 접근할 수 있는 텍스트라는 의미인데, 실질적으로는 웹 브라우저를 통해 보고 있는 컨텐츠라고 생각해도 좋다. 우리는 HTTP를 이용해서 HTML 문서를 주고 받는다. 이 경우에는 데이터가 평문으로 전송되기 때문에 패킷을 탈취되었을 경우 개인 정보가 노출 될 수 있다는 위험이 있다.

# 2. HTTPS(HTTP over Secure Socket Layer)

HTTP에 보안이 강화된 버전이다. 보안의 강화는 SSL 인증서를 통해 이루어진다. SSL은 Certificate Authority라고 불리는 서드 파티로부터 서버와 클라이언트의 인증을 하는데 사용된다. 현재는 TLS라고 해서 발전된 방법이 있는데, SSL에 이미 익숙해져 똑같이 SSL이라고 부르기도 한다.

우선 용어 정리를 먼저 해보자. 키워드가 두 가지 있다.

## 2.1. SSL(Secure Socket Layer) 인증서

클라이언트와 서버간의 통신을 제 3자가 보증해주는 전자화된 문서이다. 클라이언트가 접속할 서버가 신뢰할 수 있는 서버인지를 판단하고 SSL 통신에 사용될 공개키를 클라이언트에 전달하는 것이 목적이다. 이 때 SSL 인증서에는 서비스의 정보(CA)와 서버측 공개키에 대한 정보가 담겨있다.

## 2.2. CA(Certificate Authority)

SSL 인증서를 기준으로 클라이언트가 접속한 서버가 의도한 서버가 맞는지를 확인해주는 회사들을 CA라고 한다. 브라우저들은 CA의 리스트와 CA들의 공개키를 내장하고 있다.

# 3. TLS handshake

클라이언트가 서버를 신뢰하고 데이터를 암호화해서 보내기 위해 적용되는 과정이다.

1. 클라이언트가 자신의 TLS 버전, 암호 알고리즘 목록, 가능한 압축 방식을 `ClientHello` 메세지에 담아 서버로 보낸다.
2. 서버는 메세지를 보고 TLS, 알고리즘, 압축 방식을 선택하고 그 정보와 CA가 사인한 공개 인증서를 `ServerHello` 메세지에 담아 답장한다. 이 인증서에는 클라이언트가 나머지 handshake 과정을 암호화하는 데 사용할 공개키를 담고 있다.
3. 클라이언트는 서버의 인증서가 유효한지를 브라우저의 CA 목록을 통해서 확인한다. CA를 통해 신뢰성이 확보되면 클라이언트는 의사 난수 바이트를 생성해서 서버의 공개키로 암호화한 후 다시 서버로 전송한다.
4. 서버는 전달받은 바이트를 개인키로 복호화해서 앞으로의 통신에 사용할 대칭키를 생성한다.
5. 클라이언트는 `Finished` 메세지를 서버에 보내면서 지금까지의 교환 내역을 해싱한 값을 대칭키로 암호화하여 전송한다.
6. 서버도 해시값을 생성해 클라이언트로부터 받은 값과 일치하는지 확인한 후, 일치한다면 `Finished` 메세지를 클라이언트에게 보낸다.
7. 이때부터 데이터를 전송할 때 대칭키로 암호화하여 전송할 수 있다.
